#
# Splunk props configuration file
#
# See https://docs.splunk.com/Documentation/Splunk/9.0.0/Admin/Propsconf for the file specification.
#

[fastly]
category = Structured
description = Fastly real-time log streaming to the Splunk HTTP Event Collector

INDEXED_EXTRACTIONS = JSON
KV_MODE = none

EXTRACT-url = https?:\/\/(?<url_domain>[^\/]+)(?<uri_path>[^?]+)(?<uri_query>\?[^#]+)? in url

EVAL-bytes = bytes_in + bytes_out
EVAL-http_user_agent_length = length(http_user_agent)
EVAL-vendor_product = "Fastly"

FIELDALIAS-dest = dest AS dest_name
